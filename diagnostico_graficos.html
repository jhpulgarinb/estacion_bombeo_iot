<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>DiagnÃ³stico de GrÃ¡ficos</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            margin: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #333;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .chart-test {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
        }
        
        canvas {
            max-height: 300px;
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-weight: bold;
        }
        
        .status.ok {
            background: #d4edda;
            color: #155724;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”§ DiagnÃ³stico de GrÃ¡ficos - Dashboard</h1>
        
        <div class="controls">
            <button onclick="testAllCharts()">Probar Todos los GrÃ¡ficos</button>
            <button onclick="location.href='http://localhost:9000'">Ir al Dashboard</button>
        </div>
        
        <div class="grid">
            <div class="chart-test">
                <h3>Caudal (mÂ³/s)</h3>
                <canvas id="testFlow"></canvas>
                <div id="flowStatus" class="status"></div>
            </div>
            
            <div class="chart-test">
                <h3>Nivel de Agua (m)</h3>
                <canvas id="testLevel"></canvas>
                <div id="levelStatus" class="status"></div>
            </div>
            
            <div class="chart-test">
                <h3>PrecipitaciÃ³n (mm)</h3>
                <canvas id="testPrecip"></canvas>
                <div id="precipStatus" class="status"></div>
            </div>
            
            <div class="chart-test">
                <h3>Viento (km/h)</h3>
                <canvas id="testWind"></canvas>
                <div id="windStatus" class="status"></div>
            </div>
            
            <div class="chart-test">
                <h3>Temperatura (Â°C)</h3>
                <canvas id="testTemp"></canvas>
                <div id="tempStatus" class="status"></div>
            </div>
            
            <div class="chart-test">
                <h3>PresiÃ³n (hPa)</h3>
                <canvas id="testPressure"></canvas>
                <div id="pressureStatus" class="status"></div>
            </div>
        </div>
    </div>

    <script>
        const chartConfigs = {
            flow: {
                canvas: 'testFlow',
                label: 'Caudal (mÂ³/s)',
                color: 'rgb(34, 197, 94)',
                min: 0,
                max: 3
            },
            level: {
                canvas: 'testLevel',
                label: 'Nivel (m)',
                color: 'rgb(59, 130, 246)',
                min: 0,
                max: 5
            },
            precip: {
                canvas: 'testPrecip',
                label: 'PrecipitaciÃ³n (mm)',
                color: 'rgb(96, 165, 250)',
                min: 0,
                max: 10
            },
            wind: {
                canvas: 'testWind',
                label: 'Viento (km/h)',
                color: 'rgb(34, 211, 238)',
                min: 0,
                max: 40
            },
            temp: {
                canvas: 'testTemp',
                label: 'Temperatura (Â°C)',
                color: 'rgb(234, 179, 8)',
                min: 15,
                max: 35
            },
            pressure: {
                canvas: 'testPressure',
                label: 'PresiÃ³n (hPa)',
                color: 'rgb(155, 89, 182)',
                min: 1000,
                max: 1025
            }
        };
        
        function generateData(min, max, points = 12) {
            const data = [];
            for (let i = 0; i < points; i++) {
                data.push(Math.random() * (max - min) + min);
            }
            return data;
        }
        
        function createTestChart(configKey) {
            const config = chartConfigs[configKey];
            const canvas = document.getElementById(config.canvas);
            const statusDiv = document.getElementById(configKey + 'Status');
            
            try {
                const labels = Array.from({length: 12}, (_, i) => `${i}:00`);
                const data = generateData(config.min, config.max, 12);
                
                const chart = new Chart(canvas, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: config.label,
                            data: data,
                            borderColor: config.color,
                            backgroundColor: config.color + '20',
                            tension: 0.3,
                            fill: true,
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                min: config.min,
                                max: config.max
                            }
                        }
                    }
                });
                
                statusDiv.className = 'status ok';
                statusDiv.textContent = 'âœ“ GrÃ¡fico funcionando correctamente';
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = `âœ— Error: ${error.message}`;
                console.error(`Error en ${configKey}:`, error);
            }
        }
        
        function testAllCharts() {
            Object.keys(chartConfigs).forEach(key => {
                createTestChart(key);
            });
            console.log('âœ“ Todos los grÃ¡ficos fueron probados');
        }
        
        // Ejecutar automÃ¡ticamente al cargar
        window.addEventListener('load', () => {
            console.log('ðŸ“Š DiagnÃ³stico de grÃ¡ficos iniciado');
            testAllCharts();
        });
    </script>
</body>
</html>
